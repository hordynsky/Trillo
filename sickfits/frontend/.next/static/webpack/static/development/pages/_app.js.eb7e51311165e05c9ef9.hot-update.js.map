{"version":3,"file":"static/webpack/static/development/pages/_app.js.eb7e51311165e05c9ef9.hot-update.js","sources":["webpack:///./components/RemoveFromCart.js"],"sourcesContent":["import React from 'react';\nimport { Mutation } from 'react-apollo';\nimport styled from 'styled-components';\nimport PropTypes from 'prop-types';\nimport gql from 'graphql-tag';\nimport { CURRENT_USER_QUERY } from './User';\n\nconst REMOVE_FROM_CART_MUTATION = gql`\n    mutation RemoveFromCart($id: ID!){\n        removeFromCart(id: $id){\n            id\n        }\n    }\n`;\n\nconst BigButton = styled.button`\n    font-size: 3rem;\n    background: none;\n    border: 0;\n    &:hover{\n        color: ${props => props.theme.red};\n        cursor: pointer;\n    }\n`;\n\nclass RemoveFromCart extends React.Component {\n    static propTypes = {\n        id: PropTypes.string.isRequired\n    }\n    // This gets called as soon as we get a response back from the server after a mutation has been performed\n    update = (cache, payload) => {\n        // 1. first read the cache\n        const data = cache.readQuery({\n            query: CURRENT_USER_QUERY\n        })\n        // 2. remove that item from the cart\n        const cartItemId = payload.data.removeFromCart.id;\n        data.me.cart = data.me.cart.filter(cartItem => cartItem.id != cartItemId)\n        // 3. write it back to the cache \n        cache.writeQuery({\n            query: CURRENT_USER_QUERY,\n            data\n        })\n    }\n\n    render(){\n        return <Mutation mutation={REMOVE_FROM_CART_MUTATION} variables={{id: this.props.id}} update={this.update} optimisticResponse={{\n            __typename: 'CartItem',\n            removeFromCart: {\n                id: this.props.id\n            }\n        }}>\n            {(removeFromCart, { loading, error}) => (\n                <BigButton \n                    title=\"Delete Item\" \n                    onClick={() => {removeFromCart().catch(error => alert(err.message))}}\n                    disabled={loading}>\n                    &times;\n                </BigButton>\n            )}\n        </Mutation>\n    }\n}\n\nexport default RemoveFromCart;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAQA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AAIA;;;;;;;;;;;;;;;;;;AAKA;AACA;AACA;AACA;AADA;AACA;AAGA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;;;;;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AASA;;;;AApCA;AACA;AADA;AAEA;AACA;AAFA;AACA;AAqCA;;;;A","sourceRoot":""}